<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Water Tank (Trap Rain Water) — Visualizer</title>

  <style>
    :root {
      --bg:#0f172a;
      --card:#0b1220;
      --accent:#06b6d4;
      --muted:#94a3b8;
      --water:#60a5fa;
    }

    * { box-sizing: border-box }

    body {
      font-family: Inter, Segoe UI, Roboto, Arial;
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(180deg,#021026 0%, #06172a 100%);
      color: #e6eef8;
      display: flex;
      justify-content: center;
      padding: 32px;
    }

    .wrap {
      width: 980px;
      max-width: 96%;
    }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      padding: 18px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(2,6,23,0.6);
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    input {
      flex: 1;
      min-width: 220px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.06);
      background: transparent;
      color: inherit;
    }

    button {
      padding: 10px 12px;
      border-radius: 8px;
      border: none;
      background: var(--accent);
      color: #022;
      font-weight: 600;
      cursor: pointer;
    }

    button.secondary {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      color: var(--muted);
    }

    svg {
      width: 100%;
      height: 320px;
      border-radius: 8px;
    }

    pre {
      background: rgba(255,255,255,0.02);
      padding: 12px;
      border-radius: 8px;
    }

    .small {
      font-size: 13px;
      color: var(--muted);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h2>Water Tank — Visualizer</h2>
      <p class="small">Enter block heights and see trapped water visually</p>

      <div class="controls">
        <input id="arrInput" value="0,4,0,0,0,6,0,6,4,0">
        <button id="computeBtn">Compute</button>
        <button id="exampleBtn" class="secondary">Load Example</button>
        <button id="clearBtn" class="secondary">Clear</button>
      </div>

      <p class="small">Array:</p>
      <pre id="arrayOut"></pre>

      <p class="small">Total Water: <strong id="totalOut"></strong></p>

      <svg id="vizSVG" viewBox="0 0 100 40" preserveAspectRatio="xMidYMax meet"></svg>

      <p class="small">Per-index water:</p>
      <pre id="perIndex"></pre>
    </div>
  </div>

<script>
function parseInput(s) {
  return s.split(",")
    .map(x => Number(x.trim()))
    .filter(x => !isNaN(x) && x >= 0);
}

function computeWater(heights) {
  const n = heights.length;
  const left = Array(n).fill(0);
  const right = Array(n).fill(0);

  left[0] = heights[0];
  for (let i = 1; i < n; i++)
    left[i] = Math.max(left[i-1], heights[i]);

  right[n-1] = heights[n-1];
  for (let i = n-2; i >= 0; i--)
    right[i] = Math.max(right[i+1], heights[i]);

  let water = Array(n).fill(0), total = 0;
  for (let i = 0; i < n; i++) {
    water[i] = Math.max(0, Math.min(left[i], right[i]) - heights[i]);
    total += water[i];
  }
  return { water, total };
}

function renderSVG(h, w) {
  const svg = document.getElementById("vizSVG");
  svg.innerHTML = "";
  if (!h.length) return;

  const maxH = Math.max(...h, 1);
  const scale = 30 / maxH;
  const width = 100 / h.length;

  h.forEach((val, i) => {
    const x = i * width;
    const blockH = val * scale;

    svg.innerHTML += `
      <rect x="${x}" y="${40-blockH}" width="${width-1}" height="${blockH}" fill="#06b6d4"/>
    `;

    if (w[i] > 0) {
      const waterH = w[i] * scale;
      svg.innerHTML += `
        <rect x="${x}" y="${40-blockH-waterH}" width="${width-1}" height="${waterH}" fill="#60a5fa"/>
      `;
    }
  });
}

function run() {
  const arr = parseInput(arrInput.value);
  arrayOut.textContent = JSON.stringify(arr);
  const { water, total } = computeWater(arr);
  totalOut.textContent = total + " units";
  perIndex.textContent = water.map((v,i)=>`${i}:${v}`).join(", ");
  renderSVG(arr, water);
}

computeBtn.onclick = run;
exampleBtn.onclick = () => {
  arrInput.value = "0,4,0,0,0,6,0,6,4,0";
  run();
};
clearBtn.onclick = () => {
  arrInput.value = "";
  arrayOut.textContent = "[]";
  totalOut.textContent = "";
  perIndex.textContent = "";
  vizSVG.innerHTML = "";
};

run();
</script>
</body>
</html>
